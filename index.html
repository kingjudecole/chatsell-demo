<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pokemon Data Generator</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 1200px;
            margin: 50px auto;
            padding: 20px;
        }
        button {
            background-color: #4472C4;
            color: white;
            padding: 15px 30px;
            font-size: 16px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }
        button:hover {
            background-color: #365a9e;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 12px;
            text-align: left;
        }
        th {
            background-color: #4472C4;
            color: white;
        }
        tr:nth-child(even) {
            background-color: #f2f2f2;
        }
    </style>
</head>
<body>
    <h1>Pokemon Data Generator</h1>
    <button onclick="generateAndDownload()">Generate Pokemon Data & Download Excel</button>
    <button onclick="generateAndDisplay()">Generate & Display Only</button>
    
    <div id="output"></div>

    <script>
        const pokemonNames = [
            "Pikachu", "Charizard", "Bulbasaur", "Squirtle", "Eevee",
            "Mewtwo", "Dragonite", "Gyarados", "Snorlax", "Gengar",
            "Lucario", "Garchomp", "Greninja", "Blaziken", "Rayquaza",
            "Metagross", "Salamence", "Tyranitar", "Alakazam", "Machamp"
        ];

        const pokemonTypes = [
            "Fire", "Water", "Grass", "Electric", "Psychic",
            "Dark", "Dragon", "Fighting", "Flying", "Ghost",
            "Ice", "Normal", "Poison", "Rock", "Steel"
        ];

        const locations = [
            {city: "Tokyo, Japan", lat: 35.6762, lon: 139.6503},
            {city: "New York, USA", lat: 40.7128, lon: -74.0060},
            {city: "London, UK", lat: 51.5074, lon: -0.1278},
            {city: "Paris, France", lat: 48.8566, lon: 2.3522},
            {city: "Sydney, Australia", lat: -33.8688, lon: 151.2093},
            {city: "Rio de Janeiro, Brazil", lat: -22.9068, lon: -43.1729},
            {city: "Mumbai, India", lat: 19.0760, lon: 72.8777},
            {city: "Cairo, Egypt", lat: 30.0444, lon: 31.2357},
            {city: "Moscow, Russia", lat: 55.7558, lon: 37.6173},
            {city: "Toronto, Canada", lat: 43.6532, lon: -79.3832}
        ];

        function getRandomElement(array) {
            return array[Math.floor(Math.random() * array.length)];
        }

        function getRandomInt(min, max) {
            return Math.floor(Math.random() * (max - min + 1)) + min;
        }

        function generatePokemonData(numPokemon = 20) {
            const data = [];
            
            for (let i = 0; i < numPokemon; i++) {
                const name = getRandomElement(pokemonNames);
                const type = getRandomElement(pokemonTypes);
                const level = getRandomInt(1, 100);
                const cp = getRandomInt(100, 5000);
                const location = getRandomElement(locations);
                
                const lat = (location.lat + (Math.random() * 0.2 - 0.1)).toFixed(6);
                const lon = (location.lon + (Math.random() * 0.2 - 0.1)).toFixed(6);
                
                data.push({
                    ID: i + 1,
                    Name: name,
                    Type: type,
                    Level: level,
                    CP: cp,
                    Location: location.city,
                    Latitude: parseFloat(lat),
                    Longitude: parseFloat(lon)
                });
            }
            
            return data;
        }

        function generateAndDisplay() {
            const data = generatePokemonData(20);
            
            let html = '<table><thead><tr>';
            html += '<th>ID</th><th>Name</th><th>Type</th><th>Level</th><th>CP</th><th>Location</th><th>Latitude</th><th>Longitude</th>';
            html += '</tr></thead><tbody>';
            
            data.forEach(pokemon => {
                html += `<tr>
                    <td>${pokemon.ID}</td>
                    <td>${pokemon.Name}</td>
                    <td>${pokemon.Type}</td>
                    <td>${pokemon.Level}</td>
                    <td>${pokemon.CP}</td>
                    <td>${pokemon.Location}</td>
                    <td>${pokemon.Latitude}</td>
                    <td>${pokemon.Longitude}</td>
                </tr>`;
            });
            
            html += '</tbody></table>';
            document.getElementById('output').innerHTML = html;
        }

        function generateAndDownload() {
            const data = generatePokemonData(20);
            
            const ws = XLSX.utils.json_to_sheet(data);
            const wb = XLSX.utils.book_new();
            XLSX.utils.book_append_sheet(wb, ws, "Pokemon Data");
            
            XLSX.writeFile(wb, "pokemon_data.xlsx");
            
            alert("Excel file downloaded successfully!");
        }
    </script>
</body>
</html>
